<form action="/Inventory/AddNonConsumable" method="POST" enctype="multipart/form-data">
    <div class="form-group">
        <label for="Image">Image:</label>
        <input type="file" id="Image" name="Image" class="form-control-file" accept="image/*" style="display: none;">
        <div id="drop-area" role="button" aria-label="Drag and drop area for image upload" tabindex="0" style="border: 2px dashed #ccc; padding: 20px; text-align: center;">
            <p>Drag and drop an image here.</p>
            <div id="preview-container" style="margin-top: 20px;"></div>
        </div>
        <input type="file" id="visible-input" name="VisibleImage" class="form-control-file" accept="image/*" style="margin-top: 10px;">
    </div>
    <div class="form-group">
        <label for="Name">Name:</label>
        <input type="text" id="Name" name="Name" class="form-control" required />
    </div>
    <div class="form-group">
        <label for="Description">Description:</label>
        <input type="text" id="Description" name="Description" class="form-control" required />
    </div>
    <div class="form-group">
        <label for="RoomNumber">Room Number:</label>
        <input type="number" id="RoomNumber" name="RoomNumber" class="form-control" required />
    </div>
    <div class="form-group">
        <label for="CategoryID">Category:</label>
        <select class="form-control" id="CategoryID" name="CategoryID">
            @foreach (var category in ViewBag.Categories)
            {
                <option value="@category.Value">@category.Text</option>
            }
        </select>
    </div>
    <input type="hidden" id="ItemType" name="ItemType" value="NonConsumable">
    <div class="form-group">
        <label for="Comments">Comments:</label>
        <input type="text" id="Comments" name="Comments" class="form-control" />
    </div>
    <div class="form-group">
        <label for="assetTag">Asset Tag:</label>
        <input type="text" id="assetTag" name="AssetTag" class="form-control" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Non-Consumable</button>
    <a href="javascript:history.back()" class="btn btn-secondary">Back</a>
</form>

<script>
    document.addEventListener('DOMContentLoaded', (event) => {
    let dropArea = document.getElementById('drop-area');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false)
    });

    function preventDefaults (e) {
        e.preventDefault();
        e.stopPropagation();
    }

    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
        let dt = e.dataTransfer;
        let files = dt.files;

        document.getElementById('Image').files = files;

        handleFiles(files);
    }

    function handleFiles(files) {
        files = [...files];
        files.forEach(previewFile);
    }

    function previewFile(file) {
        let reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onloadend = function() {
            let img = document.createElement('img');
            img.src = reader.result;
            document.getElementById('preview-container').appendChild(img);
        };
    }
});
</script>
